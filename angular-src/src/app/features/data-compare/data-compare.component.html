<div class="flex flex-col items-center w-full ">
    <div
        class="flex flex-col w-full max-w-full sm:max-w-4xl bg-white/90 shadow-xl rounded-2xl sm:p-10 border-primary_dark_light: px-4 py-2 border-2 border-primary_orange_1  focus:ring-primary_orange_1 focus:border-primary_orange_1 text-sm  bg-gray-50">
        <h2 class="text-3xl font-bold text-primary_orange mb-6 text-center">{{'TMP_DATA_COMPARE_TITLE' | translate}}
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full">
            <div class="flex flex-col w-full" #studentSearchArea>
                <label class="text-gray-700 text-sm mb-1 sm:mb-2">Søg efter Elev:</label>
                <input type="text" placeholder="Indtast navn på elever..." [(ngModel)]="student.searchInput"
                    (input)="onInputChange('student', studentSearch.value)"
                    (focus)="showStudentResults = true"
                    class="px-4 py-2 border-2 border-primary_orange_1 rounded-xl shadow-sm focus:ring-primary_orange_1 focus:border-primary_orange_1 text-sm w-full bg-gray-50"
                    #studentSearch />

                <!-- Loading Indicator -->
                <div *ngIf="student.isLoading" class="text-blue-500 text-sm mt-2">
                    Indlæser elever...
                </div>

                <!-- Error Message -->
                <div *ngIf="student.errorMessage" class="text-red-500 text-sm mt-2">
                    {{ student.errorMessage }}
                </div>

                <!-- Search Results & Load More -->
                <div *ngIf="student.searchResults.length > 0 && showStudentResults" class="mt-2 bg-white shadow-md rounded-lg p-2">
                    <ul class="space-y-1">
                        <li *ngFor="let stud of student.searchResults" (click)="select('student', stud)"
                            class="py-2 px-4 hover:bg-gray-100 cursor-pointer rounded">
                            {{ stud.fullName }} ({{ stud.userName }})
                        </li>
                    </ul>

                    <!-- Load More Button -->
                    <button *ngIf="student.page < student.totalPages"
                        class="mt-2 w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-center font-medium rounded-lg transition">
                        Indlæs Flere Elever
                    </button>
                </div>

                <!-- Selected Students List -->
                <div *ngIf="student.selected.length > 0"
                    class="mt-2 text-sm font-medium text-gray-700 bg-gray-100 p-2 rounded-lg">
                    <strong>Valgte Elever:</strong>
                    <ul class="mt-1 space-y-1">
                        <li *ngFor="let stud of student.selected" class="flex justify-between items-center">
                            <span>{{ stud.fullName }} ({{ stud.userName }})</span>
                            <button (click)="select('student', stud)"
                                class="ml-2 px-2 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded">Fjern</button>
                        </li>
                    </ul>
                    <button (click)="clearSelected('student')"
                        class="mt-2 px-2 py-1 text-xs bg-gray-400 hover:bg-gray-500 text-white rounded">Ryd
                        Alle</button>
                </div>
            </div>

            <div class="flex flex-col w-full mt-4 sm:mt-0" #templateSearchArea>
                <label class="text-primary_dark_blue text-sm mb-1 sm:mb-2">Søg efter Skabelon:</label>
                <input type="text" placeholder="Indtast skabelontitel..." [(ngModel)]="template.searchInput"
                    (input)="onInputChange('template', templateSearch.value)"
                    (focus)="showTemplateResults = true"
                    class="px-4 py-2 border-2 border-primary_orange_1 rounded-xl shadow-sm focus:ring-primary_orange_1 focus:border-primary_orange_1 text-sm w-full bg-gray-50"
                    #templateSearch />

                <!-- Loading Indicator -->
                <div *ngIf="template.isLoading" class="text-blue-500 text-sm mt-2">
                    Indlæser skabeloner...
                </div>

                <!-- Error Message -->
                <div *ngIf="template.errorMessage" class="text-red-500 text-sm mt-2">
                    {{ template.errorMessage }}
                </div>

                <!-- Search Results & Load More -->
                <div *ngIf="template.searchResults.length > 0 && showTemplateResults" class="mt-2 bg-white shadow-md rounded-lg p-2">
                    <ul class="space-y-1">
                        <li *ngFor="let temp of template.searchResults" (click)="select('template', temp)"
                            class="py-2 px-4 hover:bg-gray-100 cursor-pointer rounded">
                            {{ temp.title }}
                        </li>
                    </ul>

                    <!-- Load More Button -->
                    <button *ngIf="template.page < template.totalPages"
                        class="mt-2 w-full px-4 py-2 bg-primary_orange_1 hover:bg-primary_orange_light text-white text-center font-medium rounded-xl border-2 border-primary_orange_1 hover:border-primary_dark_blue transition-colors">
                        Indlæs Flere Skabeloner
                    </button>
                </div>

                <!-- Selected Templates List -->
                <div *ngIf="template.selected.length > 0"
                    class="mt-2 text-sm font-medium text-gray-700 bg-gray-100 p-2 rounded-lg">
                    <strong>Valgte Skabeloner:</strong>
                    <ul class="mt-1 space-y-1">
                        <li *ngFor="let temp of template.selected" class="flex justify-between items-center">
                            <span>{{ temp.title }}</span>
                            <button (click)="select('template', temp)"
                                class="ml-2 px-2 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded">Fjern</button>
                        </li>
                    </ul>
                    <button (click)="clearSelected('template')"
                        class="mt-2 px-2 py-1 text-xs bg-gray-400 hover:bg-gray-500 text-white rounded">Ryd
                        Alle</button>
                </div>
            </div>
        </div>
        <div class=" flex justify-center mt-8 w-full">
            <ag-charts class="w-[800px]" [options]="chartOptions"></ag-charts>
        </div>
        <div class="flex justify-center mt-6">
            <button 
                (click)="onCompareClick()"
                [disabled]="!student.selected.length || !template.selected.length"
                class="px-6 py-3 bg-primary_orange_1 hover:bg-primary_orange_light text-white font-medium rounded-xl border-2 border-primary_orange_1 hover:border-primary_dark_blue transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                Opdater Graf
            </button>
        </div>
    </div>