<!-- Search areas for students and templates -->
 <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full">
    <div class="flex flex-col w-full mt-4 sm:mt-0" #templateSearchArea>
        <label class="text-primary_dark_blue text-sm mb-1 sm:mb-2">{{ 'DATA_COMPARE.SEARCH_TEMPLATE_LABEL' |
            translate }}</label>
        <input type="text" placeholder="Indtast skabelontitel..." [(ngModel)]="template.searchInput"
            (input)="onInputChange('template', templateSearch.value)" (focus)="showTemplateResults = true"
            class="px-4 py-2 border border-primary_orange_1 rounded-xl shadow-sm focus:ring-primary_orange_1 focus:border-primary_orange_1 text-sm w-full bg-gray-50"
            [placeholder]="'DATA_COMPARE.SEARCH_TEMPLATE_PLACEHOLDER' | translate" #templateSearch />

        <div *ngIf="template.isLoading" class="text-blue-500 text-sm mt-2">
            {{ 'DATA_COMPARE.LOADING_TEMPLATES' | translate }}
        </div>

        <div *ngIf="template.errorMessage" class="text-red-500 text-sm mt-2">
            {{ template.errorMessage }}
        </div>

        <div *ngIf="template.searchResults.length > 0 && showTemplateResults"
            class="mt-2 bg-white shadow-md rounded-lg p-2">
            <ul class="space-y-1">
                <li *ngFor="let temp of template.searchResults" (click)="select('template', temp)"
                    class="py-2 px-4 hover:bg-secondary_background_hover cursor-pointer rounded">
                    {{ temp.title }}
                </li>
            </ul>

            <button *ngIf="template.page < template.totalPages"
                class="mt-2 w-full px-4 py-2 bg-primary_orange_1 hover:bg-primary_orange_light text-white text-center font-medium rounded-xl border-2 border-primary_orange_1 hover:border-primary_dark_blue transition-colors">
                {{ 'DATA_COMPARE.LOAD_MORE_TEMPLATES' | translate }}
            </button>
        </div>

        <div *ngIf="template.selected.length > 0"
            class="mt-2 text-sm font-medium text-gray-700 bg-gray-100 p-2 rounded-lg">
            <strong>{{ 'DATA_COMPARE.SELECTED_TEMPLATES' | translate }}</strong>
            <ul class="mt-1 space-y-1">
                <li *ngFor="let temp of template.selected" class="flex justify-between items-center">
                    <span>{{ temp.title }}</span>
                    <button (click)="select('template', temp)"
                        class="ml-2 px-2 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded">{{
                        'DATA_COMPARE.REMOVE' | translate }}</button>
                </li>
            </ul>
            <button (click)="clearSelected('template')"
                class="mt-2 px-2 py-1 text-xs bg-gray-400 hover:bg-gray-500 text-white rounded">{{
                'DATA_COMPARE.CLEAR_ALL' | translate }}</button>
        </div>
    </div>


    <div class="flex flex-col w-full" #studentSearchArea>
        <label class="text-gray-700 text-sm mb-1 sm:mb-2">{{ 'DATA_COMPARE.SEARCH_STUDENT_LABEL' | translate
            }}</label>
        <input type="text" placeholder="Indtast navn på elever..." [(ngModel)]="student.searchInput"
            (input)="onInputChange('student', studentSearch.value)" (focus)="showStudentResults = true"
            class="px-4 py-2 border border-primary_orange_1 rounded-xl shadow-sm focus:ring-primary_orange_1 focus:border-primary_orange_1 text-sm w-full bg-gray-50"
            [placeholder]="'DATA_COMPARE.SEARCH_STUDENT_PLACEHOLDER' | translate" #studentSearch />

        <div *ngIf="student.isLoading" class="text-blue-500 text-sm mt-2">
            {{ 'DATA_COMPARE.LOADING_STUDENTS' | translate }}
        </div>

        <div *ngIf="student.errorMessage" class="text-red-500 text-sm mt-2">
            {{ student.errorMessage }}
        </div>

        <div *ngIf="student.searchResults.length > 0 && showStudentResults"
            class="mt-2 bg-white shadow-md rounded-lg p-2">
            <ul class="space-y-1">
                <li *ngFor="let stud of student.searchResults" (click)="select('student', stud)"
                    class="py-2 px-4 hover:bg-secondary_background_hover cursor-pointer rounded">
                    <ng-container *ngIf="stud.type === 'user'">
                        <span>{{ stud.fullName }}<span *ngIf="stud.userName"> ({{ stud.userName }})</span></span>
                    </ng-container>
                </li>
            </ul>

            <button *ngIf="student.page < student.totalPages"
                class="mt-2 w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-center font-medium rounded-lg transition">
                {{ 'DATA_COMPARE.LOAD_MORE_STUDENTS' | translate }}
            </button>
        </div>

        <div *ngIf="student.selected.length > 0"
            class="mt-2 text-sm font-medium text-gray-700 bg-gray-100 p-2 rounded-lg">
            <strong>{{ 'DATA_COMPARE.SELECTED_STUDENTS' | translate }}</strong>
            <ul class="mt-1 space-y-1">
                <li *ngFor="let stud of student.selected" class="flex justify-between items-center">
                    <ng-container *ngIf="stud.type === 'user'">
                        <span>{{ stud.fullName }}<span *ngIf="stud.userName"> ({{ stud.userName }})</span></span>
                    </ng-container>
                    <button (click)="select('student', stud)"
                        class="ml-2 px-2 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded">{{
                        'DATA_COMPARE.REMOVE' | translate }}</button>
                </li>
            </ul>
            <button (click)="clearSelected('student')"
                class="mt-2 px-2 py-1 text-xs bg-gray-400 hover:bg-gray-500 text-white rounded">{{
                'DATA_COMPARE.CLEAR_ALL' | translate }}</button>
        </div>
    </div>
</div>


<!-- Chart and Question navigation -->
<div class="flex flex-col items-center mt-8 w-full">
  <div class="controls mb-4">
    <button (click)="prevQuestion()" [disabled]="currentQuestionIndex === 0">◀ Forrige</button>
    <span class="mx-4">Spørgsmål {{ currentQuestionIndex + 1 }} / {{ totalQuestions }}</span>
    <button (click)="nextQuestion()" [disabled]="currentQuestionIndex === totalQuestions - 1">Næste ▶</button>
  </div>
  <div class="chart-container">
    <ag-charts [options]="options"></ag-charts>
  </div>
</div>